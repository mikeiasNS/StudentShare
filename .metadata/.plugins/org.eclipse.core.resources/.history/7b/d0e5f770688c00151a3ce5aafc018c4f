package br.edu.fa7.e2.SS;

import java.util.ArrayList;
import java.util.List;

import org.bson.Document;

import com.mongodb.Block;
import com.mongodb.MongoClient;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoDatabase;

public class ProfileDAO {
	
	private MongoClient mongoClient = new MongoClient();
	private MongoDatabase mongoDB = mongoClient.getDatabase("studentShareTest");

	public List<Double> TestList() {
		
		final List<Double> hum = new ArrayList<String>();
		FindIterable<Document> it = mongoDB.getCollection("workData").find(new Document("name", "Mikeias"));
		
		it.forEach(new Block<Document>() {

			@Override
			public void apply(Document doc) {
				Document d = (Document) doc.get("profile");
				Double test = d.getDouble("Dev");
				Double test1 = d.getDouble("Gest");
				Double test2 = d.getDouble("Infra");
				hum.add(test); hum.add(test1); hum.add(test2);
			}
			
		});
		
		return hum;
	}
}
