package br.edu.fa7.estagio2.dao;

import org.bson.Document;

import br.edu.fa7.estagio2.models.Client;

import com.mongodb.MongoClient;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class MongoDAO {
	private MongoClient mongoClient;
	private MongoDatabase dataBase;
	
	public MongoDAO(String DB){
		mongoClient = new MongoClient(); 
		dataBase = mongoClient.getDatabase(DB);
	}
	
	public void insert(Client client, String collection){
//		MongoCollection<Document> coll = dataBase.getCollection(collection);
		Document document = new Document("name", client.getName())
			.append("phone", client.getPhone())
			.append("age", client.getAge());
		dataBase.getCollection(collection).insertOne(document);
	}
	
	public static MongoDAO singletonDAO(){
		return new MongoDAO("aff");
	}
}
